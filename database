CREATE TABLE roles (
    role_id SERIAL PRIMARY KEY,
    role_name VARCHAR(100) UNIQUE NOT NULL
);

INSERT INTO roles (role_name) VALUES ('Super Admin'), ('Admin'), ('Staff');

ALTER TABLE users DROP COLUMN role;
ALTER TABLE users ADD COLUMN role_id INTEGER NOT NULL DEFAULT 1 REFERENCES roles(role_id);

CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    first_name VARCHAR(100),
    last_name VARCHAR(100),
    email VARCHAR(255) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    role VARCHAR(50) NOT NULL DEFAULT 'Super Admin',
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);


-- Create a new companies table with first_name and last_name
CREATE TABLE companies (
    company_id SERIAL PRIMARY KEY,
    first_name VARCHAR(100),
    last_name VARCHAR(100),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

-- Modify users table: Remove first_name, last_name, and add company_id
ALTER TABLE users
DROP COLUMN first_name,
DROP COLUMN last_name,
ADD COLUMN company_id INTEGER REFERENCES companies(company_id);

-- Alter roles setup
ALTER TABLE users DROP COLUMN role;
ALTER TABLE users ADD COLUMN role_id INTEGER NOT NULL DEFAULT 1 REFERENCES roles(role_id);






-- Table for job postings with company_id
CREATE TABLE jobs (
    job_id SERIAL PRIMARY KEY,
    company_id INTEGER NOT NULL REFERENCES companies(company_id),
    title VARCHAR(255) NOT NULL,
    description TEXT NOT NULL,
    location VARCHAR(255),
    status VARCHAR(50) NOT NULL DEFAULT 'Open', -- Examples: Open, Closed
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

-- Table for applicants with company_id
CREATE TABLE applicants (
    applicant_id SERIAL PRIMARY KEY,
    company_id INTEGER NOT NULL REFERENCES companies(company_id),
    first_name VARCHAR(100) NOT NULL,
    last_name VARCHAR(100) NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    phone VARCHAR(20),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

-- Table for applications
CREATE TABLE applications (
    application_id SERIAL PRIMARY KEY,
    job_id INTEGER NOT NULL REFERENCES jobs(job_id),
    applicant_id INTEGER NOT NULL REFERENCES applicants(applicant_id),
    application_status VARCHAR(50) NOT NULL DEFAULT 'Submitted', -- Examples: Submitted, Rejected, Shortlisted
    applied_on TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

-- Table for interviews
CREATE TABLE interviews (
    interview_id SERIAL PRIMARY KEY,
    application_id INTEGER NOT NULL REFERENCES applications(application_id),
    interview_date TIMESTAMP WITH TIME ZONE NOT NULL,
    interviewer VARCHAR(255),
    notes TEXT,
    outcome VARCHAR(50) -- Examples: Passed, Failed, On hold
);

-- Table for job offers
CREATE TABLE job_offers (
    offer_id SERIAL PRIMARY KEY,
    application_id INTEGER NOT NULL REFERENCES applications(application_id),
    offer_details TEXT,
    offered_on TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    status VARCHAR(50) NOT NULL DEFAULT 'Offered' -- Examples: Offered, Accepted, Declined
);





ADD COLUMN start_date DATE,
ADD COLUMN end_date DATE,
ADD COLUMN is_ongoing BOOLEAN DEFAULT false;